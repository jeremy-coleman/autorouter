"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var fs=require("fs"),path=require("path"),chai_1=require("chai"),autorouter_1=require("./autorouter");describe("AutoRouter",function(){before(function(){try{fs.mkdirSync("routes"),fs.mkdirSync("routes/a"),fs.writeFileSync("routes/a.js","module.exports = function(req,res,next){}"),fs.writeFileSync("routes/b.js","module.exports = function(req,res,next){}"),fs.writeFileSync("routes/a/index.js","module.exports = function(req,res,next){}")}catch(e){console.log("Files or folders already exist")}}),after(function(){fs.unlinkSync("routes/a.js"),fs.unlinkSync("routes/b.js"),fs.unlinkSync("routes/a/index.js"),fs.rmdirSync("routes/a"),fs.rmdirSync("routes")}),it("Should get the correct files",function(){var e=autorouter_1.AutoRouter.getFiles("routes"),t=autorouter_1.AutoRouter.getFiles("routes/a");chai_1.expect(e).to.deep.equal(["a","a.js","b.js"]),chai_1.expect(t).to.deep.equal(["index.js"])}),it('Should throw an error on adding "a" twice',function(){var e=new autorouter_1.AutoRouter,t=e.getRoutingFilesRecursively.bind(e,"routes","/");chai_1.expect(t).to.throw(Error,/Route \/a already exists in route map/)}),it("Should create a map of flat files",function(){var e=autorouter_1.AutoRouter.getFiles;autorouter_1.AutoRouter.getFiles=function(){return["a.js","b.js"]};var t=new autorouter_1.AutoRouter({}),r=t.getRoutingFilesRecursively("routes","/");chai_1.expect(r).to.have.property("/a","routes/a.js"),chai_1.expect(r).to.have.property("/b","routes/b.js"),autorouter_1.AutoRouter.getFiles=e}),it("Should create a map of mixed files",function(){var e=autorouter_1.AutoRouter.getFiles;autorouter_1.AutoRouter.getFiles=function(e){return"routes"===e?["a","b.js"]:["index.js"]};var t=new autorouter_1.AutoRouter({}),r=t.getRoutingFilesRecursively("routes","/");chai_1.expect(r).to.have.property("/a","routes/a/index.js"),chai_1.expect(r).to.have.property("/b","routes/b.js"),autorouter_1.AutoRouter.getFiles=e}),it("Should create an Express Router of mixed files",function(){var e=autorouter_1.AutoRouter.getFiles;autorouter_1.AutoRouter.getFiles=function(e){return e===path.join(process.cwd(),"routes")?["a","b.js"]:["index.js"]};var t=new autorouter_1.AutoRouter({}),r=t.getRouter();chai_1.expect(r).to.have.property("stack").which.have.lengthOf(2),autorouter_1.AutoRouter.getFiles=e})});